<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




























  

<link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css">

<link rel="stylesheet" href="/css/main.css?v=7.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.1">








<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="N/A">
<meta name="keywords" content="N&#x2F;A">
<meta property="og:type" content="article">
<meta property="og:title" content="Android面试临时总结">
<meta property="og:url" content="https://www.liushulun.cn/post/note/Android-temp/index.html">
<meta property="og:site_name" content="SLLiu&#39;s Blogs">
<meta property="og:description" content="N/A">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-03-14T00:31:18.036Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android面试临时总结">
<meta name="twitter:description" content="N/A">



  <link rel="alternate" href="/atom.xml" title="SLLiu's Blogs" type="application/atom+xml">



  
  
  <link rel="canonical" href="https://www.liushulun.cn/post/note/Android-temp/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Android面试临时总结 | SLLiu's Blogs</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">SLLiu's Blogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>

    <a href="/about/" class="site-titleContact">&ensp;留 言&ensp;</a>

    
      
        <h1 style="opacity: 0; font-size: 0px; margin: 0px;" itemprop="description">Learn, or Lose</h1>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="开/关导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-records">

    
    
    
      
    

    

    <a href="/records/" rel="section"><i class="menu-item-icon fa fa-fw fa-list-alt"></i> <br>记录</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-collections">

    
    
    
      
    

    

    <a href="/collections/" rel="section"><i class="menu-item-icon fa fa-fw fa-star"></i> <br>收藏</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    
  
  

  

  <a href="https://github.com/slliu96" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">

  
  
  
  <div class="post-block">

    
    
    
    
      <div class="bottom-divider">
        <style>
          .bottom-divider {
            display: table;
            padding-bottom: 10px;
            margin-bottom: 50px;
            width: 100%;
            border-bottom: 1px solid #eee;
          }
        </style>
        <div class="post-nav-next post-nav-item">
          
            <a href="/post/interview/interview-java/" rel="next" title="Java面试题汇总">
              <i class="fa fa-chevron-left"></i> Java面试题汇总
            </a>
          
        </div>

        <span class="post-nav-divider"></span>

        <div class="post-nav-prev post-nav-item">
          
        </div>
      </div>
    

    
    
    
    
    

    <link itemprop="mainEntityOfPage" href="https://www.liushulun.cn/post/note/Android-temp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SLLiu">
      <meta itemprop="description" content="Learn, or Lose">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SLLiu's Blogs">
    </span>


    
    
    
    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Android面试临时总结

              
            
          </h2>
        

        <div class="post-meta">
          
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-03-01 10:17:08" itemprop="dateCreated datePublished" datetime="2020-03-01T10:17:08+08:00">2020-03-01</time>
            

            
            
          </span>


          


          
          
          
          
            <div class="post-symbolscount" style="display: inline">

              <span class="post-meta-divider">|</span>

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">全文字数：</span>
                
                <span title="全文字数">90k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">1:40</span>
              
            </div>
          


          
          
          
          
            <span id="/post/note/Android-temp/" class="leancloud_visitors" data-flag-title="Android面试临时总结">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读量：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          


          
          
          
          



          
          
          
          
            <p>
              <font color="#999999">
                【注】本文全部内容均为原创，引用链接仅做学习指导，转载前请务必联系授权。
              </font>
            </p>
          



          
          
          
          
            
            
              <div></div>
            
          



          
          
          
          
            <span class="post-category">
              <span class="post-meta-item-icon" style="text-align:center;font-size:12px;vertical-align:middle;display:inline-block;">
                  <i class="fa fa-th"></i>
              </span>
              
                <span class="post-meta-item-text" style="text-align:center;font-size:12px;vertical-align:middle;display:inline-block;">
                  Categories:&ensp;
                </span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a style="vertical-align:middle;display:inline-block;" href="/categories/N-A/" itemprop="url" rel="index"><span itemprop="name" style="text-decoration: none; font-size:12px">N/A</span></a></span>

                
                
              
            </span>
          


          
          
          
          

            
              <span class="post-meta-divider" style="vertical-align: middle;display:inline-block;">|</span>
            

            <div class="post-tags" style="display: inline">

              <div style="text-align:center;vertical-align: middle;display:inline-block;font-size:12px;">
                <i class="fa fa-tags"></i>&ensp;Tags:&ensp;
              </div>
              
                <span style="display:inline-block;vertical-align: middle;" itemscope itemtype="http://schema.org/Thing"><a href="/tags/N-A/" rel="tag"># N/A&ensp;</a></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
      

      



        


        
        
        
        
        
          <div class="post-description"><span style="color: #EB6D39">
                  未完待续：
                </span>N/A
            
              <p>
                <style type="text/css">
                  .toContact {
                      color: #EB6D39;
                      font-size: 10px;
                      border-bottom-color: #EB6D39;
                  }
                  .toContact:hover {
                    color: #FFFFFF;
                    border-bottom-color: #FFFFFF;
                  }
                </style>
                <a href="/about/" class="toContact">本文未开启评论，点击前往留言区</a>
              </p>
            
          </div>
        

        <a id="more"></a>

<hr>
<h1 id="1-Handler工作原理√"><a href="#1-Handler工作原理√" class="headerlink" title="1. Handler工作原理√"></a>1. Handler工作原理√</h1><p>Handler处理消息时在哪个线程，和实例化这个Handler时使用的Looper有关。</p>
<p>Looper有两个重要方法，一个是prepare，一个是loop，prepare方法实例化了一个Looper对象，该Looper对象通过ThreadLocal.set(new Looper(quitAllowed))与当前线程绑定，loop方法则是开始轮询处理消息。</p>
<p>在实例化Handler时，默认构造方法中，使用ThreadLocal.get()获取Looper，因此如果当前线程没有执行过Looper.prepare，会报RuntimeException。</p>
<p>Looper对象有一个成员变量Queue，也即消息队列，消息及存在这个消息队列中。</p>
<p>线程在发送handler消息时，send或post最终都调用的sendMessageAtTime，这个方法内调用了enqueueMessage()方法，而enqueueMessage()方法内有一句msg.target = this，而msg.target就是一个Handler，因此这一句把把要发送的Message，和用来发送这个Message的Handler绑定在了一起。</p>
<p>回到Looper中，当开始loop处理时，取出一个Msg，通过这个msg.target取出Handler，而这个Handler对象构造时又通过Looper.myLooper()，实际上是在内部调用ThreadLocal.get()获取到了这个Looper，因此Handler处理消息时所在的线程是由Looper所在线程决定的。</p>
<p>由于Android的主线程即UI线程，有一定的特殊性，整个App过程中只允许存在一个UI线程，因此在UI线程运行过程中，也即执行ActivityThread的main方法，里面就有一句Looper.prepareMainLooper()，也就是将该实例对象与主线程绑定，因此在主线程使用Handler无需显式地调用prepare()。</p>
<p>如果在主线程中实例化了一个Handler对象，然后在子线程中调用并发送消息，由于该Handler在实例化时，Looper与主线程绑定，所以发送的消息可以在主线程中接收。</p>
<p>如果在子线程内部实例化Handler想要和主线程通信，可以在构造Handler时显式传入参数Looper.getMainLooper()，则获取到的也是主线程的Looper，因此也可以和主线程通信。</p>
<p>想要让主线程和子线程通信，则需要在子线程内声明Looper对象，并Looper.prepare()，looper = Looper.myLooper()实例化，Looper.loop()开始轮询，然后在主线程中实例化Handler并传入子线程的Looper，并重写handleMessage即可。</p>
<p>子线程和子线程之间的通信也可采用类似的思想，只需要将接收通信的线程的Looper传入发送通信线程的Handler即可。</p>
<p>主线程向子线程通信有可能会报错，这是因为主线程开启子线程后向下执行，Handler初始化时子线程可能还没有对Looper实例化，导致空指针。可以将该子线程用HandlerThread类代替，实例化时传入一个String作为该线程的名字。但是HandlerThread不能重写run方法，当然也不需要手动prepare和loop。</p>
<ul>
<li><a href="/post/java/java-threadlocal/" title="TOOINKS">ThreadLocal</a></li>
<li><a href="/post/android/android-message/" title="TOOINKS">Message</a></li>
<li><a href="/post/android/android-messagequeue/" title="TOLINKS">MessageQueue</a></li>
<li><a href="/post/android/android-looper/" title="TOLINKS">Looper</a></li>
<li><a href="/post/android/android-handler/" title="TOLINKS">Handler</a></li>
</ul>
<hr>
<h1 id="4-介绍一下FFmpeg"><a href="#4-介绍一下FFmpeg" class="headerlink" title="4. 介绍一下FFmpeg"></a>4. 介绍一下FFmpeg</h1><p>JNI调用FFmpeg压缩：FFmpeg的命令如：<br>mCmds = “ffmpeg -y -i “ + selectedAviFile + “ -strict -2 -vcodec libx264 -preset ultrafast -crf 20 -acodec copy -ar 44100 -ac 2 -b:a 96k -vf scale=-1:800 “ + compressedFile;<br>把这些命令按参数分成指令数组：<br>String[] cmds = mCmds.split(“ “);<br>再调用FFmpeg执行：<br>FfmpegKit.exec(cmds, new FfmpegKit.OnExecListener() {public void onExecuted(int ret)})</p>
<hr>
<h1 id="四大组件√"><a href="#四大组件√" class="headerlink" title="四大组件√"></a>四大组件√</h1><ul>
<li><a href="/post/android/android-activity/" title="TOLINKS">Activity</a></li>
<li><a href="/post/android/android-service/" title="TOLINKS">Service</a></li>
<li><a href="/post/android/android-broadcastreceiver/" title="TOLINKS">BroadcastReceiver</a></li>
<li><a href="/post/android/android-contentprovider/" title="TOLINKS">ContentProvider</a></li>
</ul>
<hr>
<h1 id="getWidth和getMeasureWidth的区别√"><a href="#getWidth和getMeasureWidth的区别√" class="headerlink" title="- getWidth和getMeasureWidth的区别√"></a>- getWidth和getMeasureWidth的区别√</h1><p><code>getMeasureWidth</code> 是 View 自己测量自己的宽度，<code>getWidth</code> 是 View 的父布局测量的高度，当屏幕可显示范围小于 View 本身的宽高时，<code>getMeasureWidth</code> 得到的仍然是 View 本身的宽高，而 <code>getWidth</code> 得到的是屏幕实际显示的宽高</p>
<hr>
<h1 id="finally什么时候执行√"><a href="#finally什么时候执行√" class="headerlink" title="finally什么时候执行√"></a>finally什么时候执行√</h1><p><a href="/post/interview/interview-android/#finally什么时候执行" title="TOLINKS">跳转</a></p>
<hr>
<h1 id="App架构√"><a href="#App架构√" class="headerlink" title="App架构√"></a>App架构√</h1><p><a href="/post/interview/interview-android/#App架构" title="TOLINKS">跳转</a></p>
<hr>
<h1 id="Java引用的实现√"><a href="#Java引用的实现√" class="headerlink" title="Java引用的实现√"></a>Java引用的实现√</h1><p><a href="/post/interview/interview-java/#Java引用的实现" title="TOLINKS">跳转</a></p>
<hr>
<h1 id="HashMap√"><a href="#HashMap√" class="headerlink" title="- HashMap√"></a>- HashMap√</h1><p>答：<a href="/post/java/java-hashmap/" title="TOLINKS">HashMap</a></p>
<hr>
<h1 id="JVM的内存模型和分区√"><a href="#JVM的内存模型和分区√" class="headerlink" title="JVM的内存模型和分区√"></a>JVM的内存模型和分区√</h1><p>答：<a href="/post/java/java-jvm/" title="TOLINKS">JVM内存模型和内存分区</a></p>
<hr>
<h1 id="方法区是否会OOM√"><a href="#方法区是否会OOM√" class="headerlink" title="方法区是否会OOM√"></a>方法区是否会OOM√</h1><p>答：会。在 JDK 1.8 以前，HotSpot 虚拟机的方法区是用永久代实现的，方法区的内存固定，因此如果频繁调用 <code>String.intern()</code> 方法，或者一次性加载太多类，会导致OOM。JDK 1.8 之后，虽然用元数据取代了方法区，直接使用本地内存，支持扩容，也取消了永久代，但并不是无限扩容的，所以仍然会，只是几率会小一些。</p>
<hr>
<h1 id="GC垃圾回收机制√"><a href="#GC垃圾回收机制√" class="headerlink" title="GC垃圾回收机制√"></a>GC垃圾回收机制√</h1><p>答：<a href="/post/java/java-gc/" title="TOLINKS">JVM的GC策略</a></p>
<hr>
<h1 id="5-StringBuffer和StringBuilder"><a href="#5-StringBuffer和StringBuilder" class="headerlink" title="5. StringBuffer和StringBuilder"></a>5. StringBuffer和StringBuilder</h1><p>StringBuffer 与 StringBuilder 中的方法和功能完全是等价的，只是StringBuffer 中的方法大都采用了 synchronized 关键字进行修饰，因此是线程安全的，而 StringBuilder 没有这个修饰，可以被认为是线程不安全的。在单线程程序下，StringBuilder效率更快，因为它不需要加锁，不具备多线程安全而StringBuffer则每次都需要判断锁，效率相对更低。StringBuffer()的初始容量可以容纳16个字符，当该对象的实体存放的字符的长度大于16时，实体容量就自动增加。StringBuffer对象可以通过length()方法获取实体中存放的字符序列长度，通过capacity()方法来获取当前实体的实际容量。StringBuffer(int size)可以指定分配给该对象的实体的初始容量参数为参数size指定的字符个数。当该对象的实体存放的字符序列的长度大于size个字符时，实体的容量就自动的增加。以便存放所增加的字符。StringBuffer(String s)可以指定给对象的实体的初始容量为参数字符串s的长度额外再加16个字符。当该对象的实体存放的字符序列长度大于size个字符时，实体的容量自动的增加，以便存放所增加的字符。扩容算法：使用append()方法在字符串后面追加东西的时候，如果长度超过了该字符串存储空间大小了就需要进行扩容：构建新的存储空间更大的字符串，将旧的复制过去；在进行字符串append添加的时候，会先计算添加后字符串大小，传入一个方法：ensureCapacityInternal 这个方法进行是否扩容的判断，需要扩容就调用expandCapacity方法进行扩容，尝试将新容量扩为大小变成2倍+2   if 判断一下 容量如果不够，直接扩充到需要的容量大小。</p>
<hr>
<h1 id="6-Android触摸事件"><a href="#6-Android触摸事件" class="headerlink" title="6. Android触摸事件"></a>6. Android触摸事件</h1><p>Android 的触摸事件有两个方向，一个是向下分发（子控件），一个是向上传递（父控件），onInterceptTouchEvent 表示是否拦截向下分发，返回 true 则子控件不会响应触摸事件，返回 false 则子控件的 onInterceptTouchEvent 被调用。onTouchEvent 表示是否处理事件，返回 true 则表示触摸事件在该 View 处理，不再向上传递。通常，ViewGroup 的 onInterceptTouchEvent 返回 false，onTouchEvent 返回 false，子 View 如果不是 ViewGroup，则没有 onInterceptTouchEvent 方法，onTouchEvent 返回 true，需要处理事件的子 View 如果在 ACTION_DOWN 时 onTouchEvent 不返回 true，表示没有消费 ACTION_DOWN，则将无法响应 ACTION_MOVE 和 ACTION_UP。</p>
<hr>
<h1 id="7-TCP三次握手"><a href="#7-TCP三次握手" class="headerlink" title="7. TCP三次握手"></a>7. TCP三次握手</h1><p>TCP 第一次握手：C 向 S 发送一个连接请求，包括一个 SYN=1，seq=随机数i，C 进入 SYN_SENT 状态；第二次握手：S 收到请求后，回应一个：SYN=1，ACK=1，ack=i+1，seq=随机数j，S 进入 SYN_RCVD 状态；第三次握手：C 收到回应后，发送一个 ACK=1，ack=j+1，S 接收并确认后，双方建立连接，进入 ESTABLISHED 状态</p>
<hr>
<h1 id="8-TCP四次挥手"><a href="#8-TCP四次挥手" class="headerlink" title="8. TCP四次挥手"></a>8. TCP四次挥手</h1><p>TCP 第一次挥手：C 发送一个 FIN=随机数k，C 进入 FIN_WAIT_1 状态，此时 C 已停止发送数据，但 S 还在监听，还能发送数据；第二次挥手：S 回应一个 ack=k+1，S 进入 CLOSE_WAIT 状态，C 确认后进入 FIN_WAIT_2 状态，此时服务器已经获取到 C 即将断开的信号，但 S 仍在活跃状态；第三次挥手：S 发送一个 FIN=随机数l，S 进入 LAST_ACK 状态，S 停止监听，进入等待断开状态，此时 C 和 S 均已停止数据交互；第四次挥手：C 确认了 S 的 FIN 后，C 进入 TIME_WAIT 状态，再发送一个 ACK=1，ack=l+1，S 进入 CLOSED 状态，挥手完成，连接断开。</p>
<hr>
<h1 id="9-基于-TCP-的-Socket："><a href="#9-基于-TCP-的-Socket：" class="headerlink" title="9. 基于 TCP 的 Socket："></a>9. 基于 TCP 的 Socket：</h1><p>Socket socket = new Socket(String ip, int port); // 本地进程间通信使用 “localhost”<br>boolean isConnected = socket.isConnected();<br>BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(socket.getOutputStream()));<br>writer.write(byte[] data);<br>writer.flush();<br>writer.close();</p>
<p>DataInputStream input = new DataInputStream(new BufferedInputStream(socked.getInputStream));<br>byte[] bytes = new byte[MAX_LENGTH_EACH_TIME];<br>while(input.read(bytes) != -1) {</p>
<p>}<br>服务端：<br>ServerSocket serverSocket = new ServerSocket(int port);<br>Socket socket = ServerSocket.accept();<br>InputStream ……</p>
<hr>
<h1 id="10-基于-UDP-的-Socket："><a href="#10-基于-UDP-的-Socket：" class="headerlink" title="10. 基于 UDP 的 Socket："></a>10. 基于 UDP 的 Socket：</h1><p>// 发送<br>DatagramSocket socket = new DatagramSocket();<br>socket.connect(String ip, int port);<br>DatagramPacket  sendPacket = new DatagramPacket(byte[] data, int data.length, String ip, int port);<br>socket.send(sendPacket);<br>// 接收<br>while(socket.isConnect()) {<br>    byte[] data = new byte[MAX_LENGTH_EACH_TIME];<br>    DatagramPacket rcvPacket = new DatagramPacket(data, data.length);<br>    socket.receive(rcvPacket);<br>    rcvPacket.getData().length // 等效于 data.length，等于 MAX_LENGTH_EACH_TIME<br>    rcvPacket.getLength() // 实际接收的数据长度，最大 64k<br>    ……<br>}</p>
<hr>
<h1 id="12-隐式启动Service"><a href="#12-隐式启动Service" class="headerlink" title="12. 隐式启动Service"></a>12. 隐式启动Service</h1><p>Android5.0之前才能隐式启动Service，也即可以只定义ActionName，不定义包名：setPackage()和不定义Component：setComponent()。在Service端创建一个服务类继承自Service，然后在manifest中声明，定义好actionname，如果actionName就是Service的全路径，则默认exported:true，然后在客户端，实例化一个Intent，设置Action即为Service的ActionName，如果Service不属于当前App进程，则还需要指定Service的包名setPackage()。<br>5.0之后如果采用隐式，会抛出一个异常，提示“Service Intent must be explicit”，官方解释是：“To ensure your app is secure”，主要应该是避免App恶意启动<br>Service不论前台后台，都运行在主线程中。如果需要执行耗时操作，需要在Service中手动启动一个子线程。</p>
<hr>
<h1 id="14-View的绘制流程"><a href="#14-View的绘制流程" class="headerlink" title="14. View的绘制流程"></a>14. View的绘制流程</h1><p><a href="https://blog.csdn.net/sinat_27154507/article/details/79748010" target="_blank" rel="noopener">https://blog.csdn.net/sinat_27154507/article/details/79748010</a></p>
<p>View 绘制中主要流程分为measure，layout， draw 三个阶段。</p>
<ul>
<li>measure ：根据父 view 传递的 MeasureSpec 进行计算大小。</li>
<li>layout ：根据 measure 子 View 所得到的布局大小和布局参数，将子View放在合适的位置上。</li>
<li>draw ：把 View 对象绘制到屏幕上。</li>
</ul>
<p>Window，ViewRootImpl，DecorView之间的联系：</p>
<p>一个 Activity 包含一个Window，Window是一个抽象基类，是 Activity 和整个 View 系统交互的接口，只有一个子类实现类PhoneWindow，提供了一系列窗口的方法，比如设置背景，标题等。一个PhoneWindow 对应一个 DecorView 跟 一个 ViewRootImpl，DecorView 是ViewTree 里面的顶层布局，是继承于FrameLayout，包含两个子View，一个id=statusBarBackground 的 View 和 LineaLayout，LineaLayout 里面包含 title 跟 content，title就是平时用的TitleBar或者ActionBar，contenty也是 FrameLayout，activity通过 setContent（）加载布局的时候加载到这个View上。ViewRootImpl 就是建立 DecorView 和 Window 之间的联系。</p>
<p>View绘制的三个阶段的核心入口是在 ViewRootImpl 类的 performTraversals() 方法中。</p>
<hr>
<h1 id="15-了解的设计模式"><a href="#15-了解的设计模式" class="headerlink" title="15. 了解的设计模式"></a>15. 了解的设计模式</h1><h2 id="15-1-单例模式"><a href="#15-1-单例模式" class="headerlink" title="15.1 单例模式"></a>15.1 单例模式</h2><h3 id="15-1-1-饿汉式"><a href="#15-1-1-饿汉式" class="headerlink" title="15.1.1 饿汉式"></a>15.1.1 饿汉式</h3><p>饿汉式写法简单，线程安全，但没有懒加载的效果，如果没有使用过会浪费内存</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton singleton = <span class="keyword">new</span> Singleton();</span><br><span class="line">    <span class="function">pubilc <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> singleton; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="15-1-2-懒汉式"><a href="#15-1-2-懒汉式" class="headerlink" title="15.1.2 懒汉式"></a>15.1.2 懒汉式</h3><p>懒汉式：懒加载，节约内存，但线程不安全</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="keyword">private</span> stati Singleton singleton = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function">pubilc <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) &#123;</span><br><span class="line">            singleton = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> singleton;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="15-1-3-线程安全的懒汉式"><a href="#15-1-3-线程安全的懒汉式" class="headerlink" title="15.1.3 线程安全的懒汉式"></a>15.1.3 线程安全的懒汉式</h3><p>线程安全的懒汉式：懒加载同时线程安全，但使用锁会造成不必要的同步开销，大部分情况下用不到同步</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="keyword">private</span> stati Singleton singleton = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function">pubilc <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (singleton == <span class="keyword">null</span>) &#123;</span><br><span class="line">            singleton = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> singleton;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="15-1-4-双锁检测"><a href="#15-1-4-双锁检测" class="headerlink" title="15.1.4 双锁检测"></a>15.1.4 双锁检测</h3><p>双锁检测：懒加载，线程安全，效率高，但 volatile 影响一点性能，高并发下有一定的缺陷。volatile 关键字可以禁止代码重排序，所有的写（write）操作都将发生在读（read）操作之前，保证singleton是一定被初始化了的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> Singleton singleton;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == singleton) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> == singleton) &#123;</span><br><span class="line">                    singleton = <span class="keyword">new</span> Singleton();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> singleton;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="15-1-5-静态内部类"><a href="#15-1-5-静态内部类" class="headerlink" title="15.1.5 静态内部类"></a>15.1.5 静态内部类</h3><p>静态内部类：懒加载，线程安全，推荐使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//第一次调用getInstance方法时才加载SingletonHolder并初始化sInstance</span></span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.sInstance;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//静态内部类</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton sInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="15-2-工厂模式"><a href="#15-2-工厂模式" class="headerlink" title="15.2 工厂模式"></a>15.2 工厂模式</h2><h3 id="15-2-1-简单工厂模式"><a href="#15-2-1-简单工厂模式" class="headerlink" title="15.2.1 简单工厂模式"></a>15.2.1 简单工厂模式</h3><p>① 定义抽象产品类及公共接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>② 定义具体产品类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductA</span> <span class="keyword">extends</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"product A"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductB</span> <span class="keyword">extends</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"product B"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>③ 创建工厂类，创建具体的产品</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Product <span class="title">create</span><span class="params">(String productName)</span> </span>&#123;</span><br><span class="line">        Product product = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (productName) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"A"</span>:</span><br><span class="line">                product = <span class="keyword">new</span> ProductA();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"B"</span>:</span><br><span class="line">                product = <span class="keyword">new</span> ProductB();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="15-2-2-抽象工厂模式"><a href="#15-2-2-抽象工厂模式" class="headerlink" title="15.2.2 抽象工厂模式"></a>15.2.2 抽象工厂模式</h3><p>抽象工厂最复杂，假如有 n 种产品，m 个工厂实体，则一共会有 n x m 种产品实体。</p>
<p>① 创建抽象产品类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CPU</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">showCPU</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Memory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">showMemory</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">HD</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">showHD</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>② 创建产品实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IntelCPU</span> <span class="keyword">extends</span> <span class="title">CPU</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showCPU</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Intet CPU"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SamsungMemory</span> <span class="keyword">extends</span> <span class="title">Memory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showMemory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"三星 内存"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WdHD</span> <span class="keyword">extends</span> <span class="title">HD</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showHD</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"西部数据 硬盘"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>③ 创建抽象工厂类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ComputerFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> CPU <span class="title">createCPU</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Memory <span class="title">createMemory</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> HD <span class="title">createHD</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>④ 创建工厂实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DellComputerFactory</span> <span class="keyword">extends</span> <span class="title">ComputerFactory</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CPU <span class="title">createCPU</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> IntelCPU();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memory <span class="title">createMemory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SamsungMemory();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HD <span class="title">createHD</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> WdHD();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="15-2-3-工厂方法模式"><a href="#15-2-3-工厂方法模式" class="headerlink" title="15.2.3 工厂方法模式"></a>15.2.3 工厂方法模式</h3><p>工厂方法模式可以看成是抽象工厂模式的一个特例，当抽象工厂中，只有一种产品时，就和工厂方法一样了。</p>
<p>① 创建抽象产品类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>② 创建产品实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductA</span> <span class="keyword">extends</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"product A"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductB</span> <span class="keyword">extends</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"product B"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>③ 创建抽象工厂类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Product <span class="title">create</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>④ 创建工厂实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FactoryA</span> <span class="keyword">extends</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ProductA();<span class="comment">//创建ProductA</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FactoryB</span> <span class="keyword">extends</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ProductB();<span class="comment">//创建ProductB</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="15-3-建造者模式"><a href="#15-3-建造者模式" class="headerlink" title="15.3 建造者模式"></a>15.3 建造者模式</h2><p>① 创建产品实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Computer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String mCPU;</span><br><span class="line">    <span class="keyword">private</span> String mMemory;</span><br><span class="line">    <span class="keyword">private</span> String mHD;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCPU</span><span class="params">(String CPU)</span> </span>&#123;</span><br><span class="line">        mCPU = CPU;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMemory</span><span class="params">(String memory)</span> </span>&#123;</span><br><span class="line">        mMemory = memory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHD</span><span class="params">(String HD)</span> </span>&#123;</span><br><span class="line">        mHD = HD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>② 创建建造者抽象类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildCPU</span><span class="params">(String cpu)</span></span>;<span class="comment">//组装CPU</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildMemory</span><span class="params">(String memory)</span></span>;<span class="comment">//组装内存</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildHD</span><span class="params">(String hd)</span></span>;<span class="comment">//组装硬盘</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Computer <span class="title">create</span><span class="params">()</span></span>;<span class="comment">//返回组装好的电脑</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>③ 创建建造者实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line">    <span class="comment">//创建产品实例</span></span><br><span class="line">    <span class="keyword">private</span> Computer mComputer = <span class="keyword">new</span> Computer();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildCPU</span><span class="params">(String cpu)</span> </span>&#123;<span class="comment">//组装CPU</span></span><br><span class="line">        mComputer.setCPU(cpu);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildMemory</span><span class="params">(String memory)</span> </span>&#123;<span class="comment">//组装内存</span></span><br><span class="line">        mComputer.setMemory(memory);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildHD</span><span class="params">(String hd)</span> </span>&#123;<span class="comment">//组装硬盘</span></span><br><span class="line">        mComputer.setHD(hd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Computer <span class="title">create</span><span class="params">()</span> </span>&#123;<span class="comment">//返回组装好的电脑</span></span><br><span class="line">        <span class="keyword">return</span> mComputer;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>④ 创建指挥者实体类，用于控制建造者进行建造任务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Director</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Builder mBuild = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Director</span><span class="params">(Builder build)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mBuild = build;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//指挥装机人员组装电脑</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Construct</span><span class="params">(String cpu, String memory, String hd)</span> </span>&#123;</span><br><span class="line">        mBuild.buildCPU(cpu);</span><br><span class="line">        mBuild.buildMemory(memory);</span><br><span class="line">        mBuild.buildHD(hd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="15-4-中介者模式"><a href="#15-4-中介者模式" class="headerlink" title="15.4 中介者模式"></a>15.4 中介者模式</h2><p>当程序存在大量的类时，多个对象之间存在着依赖的关系，呈现出网状结构，那么程序的可读性和可维护性就变差了，并且修改一个类需要牵涉到其他类，不符合开闭原则。</p>
<p>当多个类之间有复杂交互时，通过创建一个中介者类，用于处理其他类之间的交互问题，提高耦合但也提高了代码逻辑清晰度和可读性，在类和类交互时，也不需要针对不同的类定制专用的接口，只需要通过中介者提供的公用接口调用即可。</p>
<hr>
<h1 id="16-开源框架"><a href="#16-开源框架" class="headerlink" title="16. 开源框架"></a>16. 开源框架</h1><p>Glide</p>
<hr>
<h1 id="17-多线程"><a href="#17-多线程" class="headerlink" title="17. 多线程"></a>17. 多线程</h1><p>线程池参数详解：</p>
<p>（1）corePoolSize 线程池核心线程大小</p>
<p>线程池中会维护一个最小的线程数量，即使这些线程处理空闲状态，他们也不会被销毁，除非设置了allowCoreThreadTimeOut。这里的最小线程数量即是corePoolSize。</p>
<p>（2）maximumPoolSize 线程池最大线程数量</p>
<p>一个任务被提交到线程池后，首先会缓存到工作队列（后面会介绍）中，如果工作队列满了，则会创建一个新线程，然后从工作队列中的取出一个任务交由新线程来处理，而将刚提交的任务放入工作队列。线程池不会无限制的去创建新线程，它会有一个最大线程数量的限制，这个数量即由maximunPoolSize来指定。</p>
<p>（3）keepAliveTime 空闲线程存活时间</p>
<p>一个线程如果处于空闲状态，并且当前的线程数量大于corePoolSize，那么在指定时间后，这个空闲线程会被销毁，这里的指定时间由keepAliveTime来设定</p>
<p>（4）unit 空间线程存活时间单位</p>
<p>keepAliveTime的计量单位</p>
<p>（5）workQueue 工作队列</p>
<p>新任务被提交后，会先进入到此工作队列中，任务调度时再从队列中取出任务。jdk中提供了四种工作队列：</p>
<p>① ArrayBlockingQueue</p>
<p>基于数组的有界阻塞队列，按FIFO排序。新任务进来后，会放到该队列的队尾，有界的数组可以防止资源耗尽问题。当线程池中线程数量达到corePoolSize后，再有新任务进来，则会将任务放入该队列的队尾，等待被调度。如果队列已经是满的，则创建一个新线程，如果线程数量已经达到maxPoolSize，则会执行拒绝策略。</p>
<p>② LinkedBlockingQuene</p>
<p>基于链表的无界阻塞队列（其实最大容量为Interger.MAX），按照FIFO排序。由于该队列的近似无界性，当线程池中线程数量达到corePoolSize后，再有新任务进来，会一直存入该队列，而不会去创建新线程直到maxPoolSize，因此使用该工作队列时，参数maxPoolSize其实是不起作用的。</p>
<p>③ SynchronousQuene</p>
<p>一个不缓存任务的阻塞队列，生产者放入一个任务必须等到消费者取出这个任务。也就是说新任务进来时，不会缓存，而是直接被调度执行该任务，如果没有可用线程，则创建新线程，如果线程数量达到maxPoolSize，则执行拒绝策略。</p>
<p>④ PriorityBlockingQueue</p>
<p>具有优先级的无界阻塞队列，优先级通过参数Comparator实现。</p>
<p>（6）threadFactory 线程工厂</p>
<p>创建一个新线程时使用的工厂，可以用来设定线程名、是否为daemon线程等等</p>
<p>（7）handler 拒绝策略</p>
<p>当工作队列中的任务已到达最大限制，并且线程池中的线程数量也达到最大限制，这时如果有新任务提交进来，该如何处理呢。这里的拒绝策略，就是解决这个问题的，jdk中提供了4中拒绝策略：</p>
<p>① CallerRunsPolicy</p>
<p>该策略下，在调用者线程中直接执行被拒绝任务的run方法，除非线程池已经shutdown，则直接抛弃任务。</p>
<p>② AbortPolicy</p>
<p>该策略下，直接丢弃任务，并抛出RejectedExecutionException异常。</p>
<p>③ DiscardPolicy</p>
<p>该策略下，直接丢弃任务，什么都不做。</p>
<p>④ DiscardOldestPolicy</p>
<p>该策略下，抛弃进入队列最早的那个任务，然后尝试把这次拒绝的任务放入队列。</p>
<hr>
<h1 id="18-HTTP和HTTPS"><a href="#18-HTTP和HTTPS" class="headerlink" title="18. HTTP和HTTPS"></a>18. HTTP和HTTPS</h1><h2 id="18-1-HTTP"><a href="#18-1-HTTP" class="headerlink" title="18.1 HTTP"></a>18.1 HTTP</h2><h2 id="18-1-1-HTTP报文格式"><a href="#18-1-1-HTTP报文格式" class="headerlink" title="18.1.1 HTTP报文格式"></a>18.1.1 HTTP报文格式</h2><p>（1）HTTP 请求报文</p>
<p>HTTP 请求报文包括：请求行（Request Line）、请求头（Request Header）、请求数据（Request Data）、空行四个部分。</p>
<p><a href="https://blog.csdn.net/zx_emily/article/details/83024065" target="_blank" rel="noopener">https://blog.csdn.net/zx_emily/article/details/83024065</a></p>
<p>SSL：<br><a href="https://www.cnblogs.com/jesse131/p/9080925.html" target="_blank" rel="noopener">https://www.cnblogs.com/jesse131/p/9080925.html</a></p>
<hr>
<h1 id="19-为什么View移动后点击事件还在原来的位置"><a href="#19-为什么View移动后点击事件还在原来的位置" class="headerlink" title="19. 为什么View移动后点击事件还在原来的位置"></a>19. 为什么View移动后点击事件还在原来的位置</h1><p>因为View平移后，只改变了View的显示位置，也就是只是在绘制时通过改变Matrix增加了平移，并没有改变在父布局中的位置。</p>
<hr>
<h1 id="20-LRU算法"><a href="#20-LRU算法" class="headerlink" title="20. LRU算法"></a>20. LRU算法</h1><h2 id="20-1-LRU算法原理"><a href="#20-1-LRU算法原理" class="headerlink" title="20.1 LRU算法原理"></a>20.1 LRU算法原理</h2><p>LRU（Least Recently Used，最近最少使用）的本质是一个链表，新数据插入到链表头部，每当缓存命中，则将数据移到链表头部，当链表满了或者需要清理内存时，将链表尾部的数据丢弃。</p>
<p>特点：当存在热点数据时，LRU 的效率很高，但偶发性的、周期性的批量操作会导致 LRU 命中率急剧下降，产生缓存污染的（将不常用的数据也存入缓存，降低了缓存效率）问题，且每次缓存命中时，都需要遍历链表，找到命中的数据块索引并移到头部。</p>
<h2 id="20-2-LRU-K"><a href="#20-2-LRU-K" class="headerlink" title="20.2 LRU-K"></a>20.2 LRU-K</h2><p>为了改善 LRU 算法的缓存污染问题，额外维护一个队列用于记录所有缓存数据被访问的历史，只有当数据的访问次数打到 K 次，才存入缓存中。当数据被访问次数不到 K 次时，按照一定规则（FIFO、LRU 等）淘汰，当历史队列中的数据访问达到 K 次后，将其从队列中删除转移到缓存中，并按照时间顺序重新排列缓存数据，且缓存中的数据每次被访问后重新排序。当需要清理缓存时，淘汰缓存中排在末尾的数据，也即淘汰距离上次访问最久的数据。</p>
<p>特点：LRU-K 降低了缓存污染带来的代价，命中率比 LRU 高，但由于其历史队列和缓存中的数据都具有优先级（可以即时排序也可以在需要淘汰数据时才排序），因此其算法复杂度和性能代价较高。尤其当有大量存入历史队列却还未存入缓存中的数据时，内存消耗较大。</p>
<p>通常，LRU-2 是综合因素下的最优选择，LRU-3 或更高 K 值会提高命中率，但适应性较差，需要大量的数据访问才能冲洗历史队列表。</p>
<h2 id="20-3-LRU-Two-Queues"><a href="#20-3-LRU-Two-Queues" class="headerlink" title="20.3 LRU-Two Queues"></a>20.3 LRU-Two Queues</h2><p>LRU-2Q 祛除了历史队列，而是直接使用两个缓存队列进行管理，其中一个缓存队列采用 FIFO 淘汰规则，另一个缓存队列采用 LRU 淘汰规则。一个新的数据首次被访问时，假如 FIFO 队列，当该数据再次被访问时，则转移到 LRU 队列中，LRU 队列中的数据再次被访问时，则移至 LRU 队列的头部，两个队列分别根据对应的淘汰规则按需淘汰数据。</p>
<p>L特点：RU-2Q 的命中率高于 LRU，尽管需要两个队列，但两个队列的维护算法都比较简单。LRU-2Q 和 LRU-2 命中率、内存消耗都比较接近，不同处在于，LRU-2 中，数据首次被访问加入历史队列后，需要被访问 2 次才转移至缓存中，而 LRU-2Q 在数据首次被访问加入 FIFO 队列后，仅需再被访问 1 次即转移到缓存中。</p>
<h2 id="20-4-LRU-Multi-Queues"><a href="#20-4-LRU-Multi-Queues" class="headerlink" title="20.4 LRU-Multi Queues"></a>20.4 LRU-Multi Queues</h2><p>LRU-MQ 拥有一个 LRU 历史队列 和 K 个 LRU 缓存队列，均采用 LRU 淘汰规则。当一个数据首次被访问时，加入到最低优先级的 LRU 缓存队列中，队列中的数据每次被访问则重新计算优先级并排序，当低优先级的队列中，当某个数据优先级达到下一级 LRU 缓存队列时，将其从当前 LRU 缓存队列转移到更高级的 LRU 缓存队列的头部。为避免高优先级的数据永不淘汰，当高优先级的 LRU 缓存队列中某个数据在指定时间内未被访问时，降低其优先级并转移到低优先级的 LRU 缓存队列的头部。所有 K 个 LRU 缓存队列中被淘汰的数据，均转移到 LRU 历史队列的头部，若 LRU 历史队列中的数据重新被访问，则重新计算优先级，并根据优先级转移到目标 LRU 缓存队列的头部，否则根据 LRU 算法直到被完全淘汰，</p>
<p>LRU-MQ 进一步降低了缓存污染的问题，着重突出了“优先缓存访问次数多的数据”的思想，但由于具有多个队列，且每个队列都需要维护每个数据的访问时间，当 LRU-MQ 中队列数和数据量过多时，具有较高的复杂度。不过，尽管 LRU-MQ 的队列数量较多，但由于内存是有限的，因此所有的队列所占内存之和仍是受限的，因此多个短队列的长度之和与单个长队列的长度相差不大，其队列扫描性能仍然比较接近。</p>
<h2 id="20-5-LRUCache"><a href="#20-5-LRUCache" class="headerlink" title="20.5 LRUCache"></a>20.5 LRUCache</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> LruCache&lt;String, Bitmap&gt; mLruCache = <span class="keyword">new</span> LruCache&lt;String, Bitmap&gt;(cacheSize) &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">sizeOf</span><span class="params">(String key, Bitmap value)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//计算一个元素的缓存大小</span></span><br><span class="line">        <span class="keyword">return</span> value.getByteCount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">addBitmap(String key, Bitmap bitmap) &#123;&#125;</span><br><span class="line">getBitmap(String key) &#123;&#125;</span><br><span class="line">removeBitmapFromMemory(String key) &#123;&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="21-内存泄漏和内存抖动检测"><a href="#21-内存泄漏和内存抖动检测" class="headerlink" title="21. 内存泄漏和内存抖动检测"></a>21. 内存泄漏和内存抖动检测</h1><h2 id="21-1-检测内存泄漏"><a href="#21-1-检测内存泄漏" class="headerlink" title="21.1 检测内存泄漏"></a>21.1 检测内存泄漏</h2><p>（1）内存泄漏的原因：</p>
<ul>
<li><p>Handler 发送的消息未被处理则会导致 MessageQueue 一直持有 Handler 和 Message 的引用，解决办法：创建静态内部 Handler 类继承自 Handler，并实例化该内部的 Handler，并且在 <code>onDestroy()</code> 方法中手动移除所有未处理的消息、或者使用进程唯一的 MainLooper 来实例化 Handler。</p>
</li>
<li><p>单例模式的生命周期通常和 App 一致，若其中传入了 Context，则会导致对应的 Context 无法被回收，此时可以改用 Application 的 Context。</p>
</li>
<li><p>使用 View、Context 等作为参数传递到外部对象中，由于 Context 和 View 对象很容易被回收，如果被外部对象持有，很可能会导致内存泄漏。可以使用弱引用 WeakReference。</p>
</li>
<li><p>非静态匿名内部类，例如一个非静态的 Runnable 对象，被用来实例化一个匿名 Thread 对象：<code>new Thread(runnable).start();</code>，由于该 Runnable 对象非静态，会自动持有其外部类的引用，则导致外部类无法被回收。可以通过把 Runnable 对象声明为 <code>static</code> 解决。</p>
</li>
<li><p>注册/反注册未成对使用，例如广播接收器，可以在 <code>onCreate()</code> 或 <code>onResume()</code> 中注册，在 <code>onDestroy()</code> 或 <code>onPause()</code> 中释放。</p>
</li>
<li><p>资源为关闭，例如 Cursor、File、Bitmap、视频等，通常内部实现了一些缓冲技术，并且可能还涉及到 Native 层，都需要手动关闭资源，否则会引起内存泄漏。</p>
</li>
<li><p>集合未及时清理，例如将一些 View、Context 等存入集合中导致无法回收，或是将集合声明为 <code>static</code>，都会导致内存泄漏。</p>
</li>
</ul>
<p>（2）内存泄漏的检测：</p>
<p>主要是引入 LeakCanary，然后在 Application 中初始化和安装，之后在设备上运行 App 即可在 LeakCanary 中自动检测。</p>
<h2 id="21-2-检测内存抖动"><a href="#21-2-检测内存抖动" class="headerlink" title="21.2 检测内存抖动"></a>21.2 检测内存抖动</h2><p>内存抖动主要是短时间内有大量对象产生和销毁，伴随着频繁的 GC，占用大量 CPU 和 UI 线程资源，导致 App 卡顿。</p>
<p>（1）内存抖动的原因：</p>
<ul>
<li><p>在循环中声明和创建对象，可以改为在外部创建对象，然后在循环内实例化。</p>
</li>
<li><p>频繁改变 <code>String</code> 对象，可以改为使用 <code>StringBuilder</code> 最后再转为 <code>String</code>。</p>
</li>
<li><p><code>View</code> 中的 <code>onDraw()</code> 方法会被频繁调用，应当尽量避免创建对象。</p>
</li>
<li><p>频繁使用的图片资源，或者复用几率较大的对象，可以建立缓存。</p>
</li>
</ul>
<p>（2）内存抖动的检测和定位：</p>
<p>使用 AndroidStudio 自带的工具 Android Profile，选择 Memory 栏，当出现 GC 时，会显示一个垃圾桶图标，如果 GC 出现的频繁，则很可能是内存抖动。</p>
<p>使用 AndroidStudio 自带的工具：Tools - Android - Android Device Monitor，打开 App，在 Monitor 工具中选择 App 对应的进程，然后运行对应的功能后，选择 DDMS 工具，查看一个 .trace 文件，在“main”栏会显示具体的抖动，找到发生抖动（柱状图起伏很大的一段）放大后，对应的找到相关的方法（方法被调用时，调用者的方法序号小于其调用的方法的序号），根据实际情况追溯到对应的方法中去查看有没有可能导致内存抖动的代码并修改。</p>
<hr>
<h1 id="22-wait-和sleep"><a href="#22-wait-和sleep" class="headerlink" title="22. wait()和sleep()"></a>22. wait()和sleep()</h1><p>sleep属于Thread，wait属于Object，因此所有的对象都能调用wait方法，而一旦一个对象被wait，必须手动通过notify或notyfyAll来唤醒，而sleep只需要指定唤醒的时间就能自我唤醒。</p>
<hr>
<h1 id="23-Java中的锁"><a href="#23-Java中的锁" class="headerlink" title="23. Java中的锁"></a>23. Java中的锁</h1><h2 id="23-1-乐观锁和悲观锁"><a href="#23-1-乐观锁和悲观锁" class="headerlink" title="23.1 乐观锁和悲观锁"></a>23.1 乐观锁和悲观锁</h2><p>悲观锁认为一定会有别的线程抢占数据，因此操作数据前都要先获取数据的锁，<code>synchronized</code> 和 <code>lock</code> 都是悲观锁，适用于写操作较多的场景。</p>
<p>乐观锁认为不会有别的线程抢占数据，因此只在写操作前判断是否有其他线程更新了数据，CAS（Compare And Swap）就是乐观锁的一种实现方式，适用于读操作较多的场景。</p>
<h2 id="23-2-同步锁"><a href="#23-2-同步锁" class="headerlink" title="23.2 同步锁"></a>23.2 同步锁</h2><p>（1）对象锁（方法锁）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(Object object) &#123; ... &#125;</span><br></pre></td></tr></table></figure>

<p>当多个线程使用同一个对象锁则可以达到同步的效果，否则无效。</p>
<p>当 <code>synchronized</code> 修饰方法时，实际上等同于获取该方法所在的外部类对象的对象锁。</p>
<p>（2）类锁（静态锁）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(DemoClass.class) &#123; ... &#125;</span><br></pre></td></tr></table></figure>

<p>同一个类只有一个类锁，但每个类的实例对象都有自己的对象锁，因此当使用类锁时，所有该类的实例对象拿到的都是同一把锁，而使用对象锁时，不同实例对象之间是无关的。</p>
<p><code>synchronized</code> 修饰静态方法时，即为静态锁。由于非静态方法会自动持有其所在外部类对象的引用，因此非静态方法加锁等同于其所在外部类实例对象的对象锁，而静态方法不会持有其外部类对象的引用，因此是使用其外部类的字节码对象作为锁。</p>
<hr>
<h1 id="25-如何优化性能"><a href="#25-如何优化性能" class="headerlink" title="25. 如何优化性能"></a>25. 如何优化性能</h1><p>（1）逻辑层</p>
<p>尽可能消除或减少内存泄漏、内存抖动。</p>
<p>（2）UI 层</p>
<ul>
<li><p>减少布局层级，可通过手机的“过渡绘制”和 AndroidStudio - Tools - Layout Inspector 查看。</p>
</li>
<li><p>使用 ViewStub 占位不常用资源。</p>
</li>
<li><p>使用简单的布局，例如在层级相同的前提下，使用 FrameLayout 或 LinearLayout 替代 RelativeLayout。</p>
</li>
<li><p>优化自定义 View 中的 <code>onDraw()</code>，避免复杂语句。</p>
</li>
</ul>
<p>（3）应用层</p>
<ul>
<li><p>耗时操作异步处理。</p>
</li>
<li><p>复用资源本地缓存。</p>
</li>
<li><p>Bitmap 优化，例如读取信息时，设置 <code>BitmapFactory.Options.inJustDecodeBounds = true;</code>，则仅读取宽高而不将具体数据读入内存，当图片过大时，对图片进行压缩，缓存一份压缩后的图片，对需要显示大图的地方，使用 <code>BitmapRegionDecoder</code>，指定 Bitmap 的区域进行解码。</p>
</li>
</ul>
<p>（4）代码层</p>
<ul>
<li><p>ListView、RecyclerView，使用 ViewHolder 复用布局。</p>
</li>
<li><p>减少枚举类。由于 JVM 使用 int 作为默认整型变量，因此在数据量大和非必要场景下，使用 int 替代 short、byte 反而性能更好。</p>
</li>
<li><p>使用 SparseArray 或 ArrayMap 代替简单的 HashMap 结构。</p>
</li>
</ul>
<p>稀疏数组是针对替换 <code>HashMap&lt;Integer, Object&gt;</code> 的，其意义在于：如果一个 HashMap 里面存的数据很少，会浪费很多空闲的内存空间，因此可以使用一个压缩后的矩阵来表示。SparseArray 矩阵，分为上下两个部分，共三列。上部分只有第一行，从左到右三列分别是：原 HashMap 的行数、原 HashMap 的列数、原 HashMap 共使用了几个元素。下部分则分别记录了原 HashMap 中使用了的元素分别在原 HashMap 中的行下标、列下标、取值。</p>
<p>ArrayMap使用两个数组来存放键值对，一个数组存放Key，另一个存放Value。</p>
<p>如果Key确定是Int，可使用SparseArray，Long可使用LongSparseArray，其他使用ArrayMap，但数据量大时，还是使用HashMap，因为SparseArray和ArrayMap使用二分法，将计算后的Hash值按从小到大的顺序排列插入和读取。</p>
<hr>
<h1 id="26-数据库常用增删改查语句"><a href="#26-数据库常用增删改查语句" class="headerlink" title="26. 数据库常用增删改查语句"></a>26. 数据库常用增删改查语句</h1><p>（1）插入数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TableName <span class="keyword">VALUES</span> (<span class="string">'data'</span>, <span class="string">'data'</span>, ...);</span><br></pre></td></tr></table></figure>

<p>（2）删除数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> TableName <span class="keyword">WHERE</span> <span class="keyword">attr</span>=<span class="string">'data'</span>;</span><br></pre></td></tr></table></figure>

<p>（3）更新数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> TableName <span class="keyword">set</span> attr1=<span class="string">'data'</span> <span class="keyword">WHERE</span> attr2=<span class="string">'data2'</span>;</span><br></pre></td></tr></table></figure>

<p>（4）查询数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableName;</span><br><span class="line"><span class="keyword">SELECT</span> attr1, attr2 <span class="keyword">FROM</span> TableName <span class="keyword">WHERE</span> <span class="keyword">attr</span>=<span class="string">'data'</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="27-进程间通信"><a href="#27-进程间通信" class="headerlink" title="27. 进程间通信"></a>27. 进程间通信</h1><p>（1）Socket</p>
<p>见上文，本机的进程间通信，相当于本机 IP，通过指定相同的端口号即可建立连接，是很多 App 偏底层功能的进程间通信机制。</p>
<p>（2）广播接收</p>
<p>（3）ContentProvider</p>
<p>（4）Service</p>
<p>（5）AIDL</p>
<p>（6）Bundle</p>
<p>智能传输 Bundle 支持的数据类型，对数据的大小有限制，通常四大组件之间的进程间通信是采用 Bundle 的形式，例如：使用 Intent 调用的各项四大组件。</p>
<hr>
<h1 id="28-线程间通信"><a href="#28-线程间通信" class="headerlink" title="28. 线程间通信"></a>28. 线程间通信</h1><p>（1）Handler</p>
<ul>
<li><p>主线程向子线程发消息：① 主线程中实例化 Handler，并在子线程中发送消息。② 子线程中实例化 Handler，但传入 MainLooper。</p>
</li>
<li><p>子线程向主线程发消息：子线程中实例化 Looper，并用在主线程中实例化 Handler。</p>
</li>
<li><p>子线程间通信：借助主线程，将接收消息的子线程的 Looper 实例化对象传给发送消息的子线程并用于实例化 Handler。</p>
</li>
</ul>
<p>（2）<code>runOnUiThread()</code></p>
<p>直接将指定代码运行在主线程。</p>
<p>（3）<code>View.post()</code></p>
<p>（4）AsyncTask</p>
<p>在主线程中调用开启后台任务，然后通过继承自 AsyncTask 的类并重写 <code>doInBackground(Object[] objs)</code> 和 <code>onPostExecute(Object obj)</code> 分别指定后台任务以及任务执行完毕后的步骤。</p>
<hr>
<h1 id="29-ANR和OOM及如何避免"><a href="#29-ANR和OOM及如何避免" class="headerlink" title="29. ANR和OOM及如何避免"></a>29. ANR和OOM及如何避免</h1><h2 id="29-1-ANR"><a href="#29-1-ANR" class="headerlink" title="29.1 ANR"></a>29.1 ANR</h2><p>ANR（Application Not Responding）出现的原因有：</p>
<p>（1）输入事件（如触摸和按键等）在 5s 内未响应。</p>
<p>（2）BroadcastReceiver 在规定时间内（前台广播 10s，后台广播 60s）未执行完 <code>onReceive()</code>，因此在 <code>onReceive()</code> 中不要执行耗时操作。</p>
<p>（3）Service 在规定时间内（前台服务 20s，后台服务 10s）未完成启动（<code>onCreate()</code>）。</p>
<p>（4）ContentProvider 在 10s 内未完成启动（<code>onCreate()</code>）。</p>
<p>发生 ANR 时，Android 会在 <code>/data/anr/</code> 下生成一个 <code>traces.txt</code>，可通过 Adb 命令导出：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span>adb pull data/anr/traces.txt</span><br></pre></td></tr></table></figure>

<p>打开文本，找到对应的进程名，在下面查找发生 ANR 相关的类、方法。</p>
<p>也有可能是 CPU 满负载、IO 阻塞、内存泄漏等等。</p>
<h2 id="29-2-OOM"><a href="#29-2-OOM" class="headerlink" title="29.2 OOM"></a>29.2 OOM</h2><p>OOM（Out Of Memory）出现的原因有：</p>
<p>（1）单次加载过大的对象，如图片。可以压缩、加载小图、绘制局部、使用第三方框架等。</p>
<p>（2）内存中资源过多，无法为新的数据开辟内存。对不用的数据及时回收、减少内存泄漏等。</p>
<p>（3）Dalvik 虚拟机分配的 Heap Size 太小。适当调整 HeapSize，可在 Manifest 中标注 <code>largeheap=true</code> 属性。</p>
<hr>
<h1 id="30-Android为什么有签名机制以及如何理解"><a href="#30-Android为什么有签名机制以及如何理解" class="headerlink" title="30. Android为什么有签名机制以及如何理解"></a>30. Android为什么有签名机制以及如何理解</h1><p><a href="https://www.jianshu.com/p/fa0e2273f2a0" target="_blank" rel="noopener">https://www.jianshu.com/p/fa0e2273f2a0</a></p>
<hr>
<h1 id="31-App沙箱化"><a href="#31-App沙箱化" class="headerlink" title="31. App沙箱化"></a>31. App沙箱化</h1><p><a href="https://blog.csdn.net/ljheee/article/details/53191397" target="_blank" rel="noopener">https://blog.csdn.net/ljheee/article/details/53191397</a></p>
<hr>
<h1 id="32-权限管理系统"><a href="#32-权限管理系统" class="headerlink" title="32. 权限管理系统"></a>32. 权限管理系统</h1><p><a href="https://blog.csdn.net/zengruiyue/article/details/96295592" target="_blank" rel="noopener">https://blog.csdn.net/zengruiyue/article/details/96295592</a></p>
<hr>
<h1 id="33-常见排序算法"><a href="#33-常见排序算法" class="headerlink" title="33. 常见排序算法"></a>33. 常见排序算法</h1><hr>
<h1 id="34-热修复的原理"><a href="#34-热修复的原理" class="headerlink" title="34. 热修复的原理"></a>34. 热修复的原理</h1><p>在编译 Android 代码时，会把代码编译成 dex 字节码，Android 在运行一个 App 时，会通过 ClassLoader 来加载 dex 文件，加载时，如果一个类或方法已经被加载，后面再加载到重复的就会跳过，因此可以通过把热更新后的类或方法编译成的 dex 文件插入到 <code>dexElements</code> 数组的头部</p>
<hr>
<h1 id="35-ListView和RecyclerView性能对比和性能优化"><a href="#35-ListView和RecyclerView性能对比和性能优化" class="headerlink" title="35. ListView和RecyclerView性能对比和性能优化"></a>35. ListView和RecyclerView性能对比和性能优化</h1><p>ListView 开发成本低，性能和功能上 RecyclerView 更优。</p>
<hr>
<h1 id="36-Bitmap加载大图"><a href="#36-Bitmap加载大图" class="headerlink" title="36. Bitmap加载大图"></a>36. Bitmap加载大图</h1><p><a href="https://www.jianshu.com/p/73aecb2b85e6" target="_blank" rel="noopener">https://www.jianshu.com/p/73aecb2b85e6</a></p>
<p>（1）设置 <code>inJustDecodeBounds</code> 来预检测图片大小。</p>
<p>（2）大图尝试先压缩显示预览图。</p>
<p>（3）当放大显示时，测量当前 ImageView 实际可显示的范围，按照实际可显示范围加载局部图（<code>BitmapRegionDecoder</code>）。</p>
<p>（4）<code>BitmapRegionDecoder.newInstance(InputStream, boolean)</code>，传入图片输入流实例化一个 <code>bitmapRegionDecoder</code>。</p>
<p>（5）编码局部：<code>bitmapRegionDecoder.decodeRegion(Rect, BitmapFactory.Options);</code></p>
<p>（6）绘制：<code>canvas.drawBitmap()</code></p>
<p>（7）通过手势监听类 GestureDetector 的实例对象在 <code>onTouch(View v, MotionEvent event)</code> 中调用 <code>gestureDetector.onTouchEvent(event)</code>，并继承重写 <code>GestureDetector.onScroll(motionEvent e1, MotionEvent e2, float distanceX, float distanceY)</code> 来监听手势变化，并重新计算需要显示的矩形范围，然后在 <code>onDraw()</code> 中重新绘制对应区域的 Bitmap。</p>
<hr>
<h1 id="37-Java中的引用"><a href="#37-Java中的引用" class="headerlink" title="37. Java中的引用"></a>37. Java中的引用</h1><h2 id="37-1-四种引用关系"><a href="#37-1-四种引用关系" class="headerlink" title="37.1 四种引用关系"></a>37.1 四种引用关系</h2><p>（1）强引用</p>
<p>直接 new 出来的对象就是强引用。只要强引用还存在，则不会被 GC，若内存不足，则 JVM 会直接抛出 OOM，可通过置为 null 来尝试回收。</p>
<p>（2）软引用 SoftReference</p>
<p>若内存足够，发生 GC 时不会被回收，若内存不足，发生 GC 时会被回收。若回收软引用对象后仍然内存不足，则抛出 OOM。使用方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SoftReference&lt;Type T&gt; sr = <span class="keyword">new</span> SoftReference&lt;&gt;(Object obj);</span><br></pre></td></tr></table></figure>

<p>（3）弱引用 WeakReference</p>
<p>不论内存是否足够，只要 GC，都会回收。</p>
<p>（4）虚引用 PhantomReference</p>
<p>一个对象持有虚引用几乎相当于未持有任何引用，随时都可能会被回收。虚引用必须配合引用队列一起使用。</p>
<p>（5）引用队列 ReferenceQueue</p>
<p>可配合软引用、弱引用、虚引用使用。当 GC 准备回收一个对象时，若发现该对象存在引用，则会先将其加入到与之关联的引用队列中，可以通过判断引用队列中是否存在引用来判断被引用的对象是否将要被回收。</p>
<h2 id="37-2-Java中引用的实现"><a href="#37-2-Java中引用的实现" class="headerlink" title="37.2 Java中引用的实现"></a>37.2 Java中引用的实现</h2><hr>
<h1 id="38-强引用置null是否回收"><a href="#38-强引用置null是否回收" class="headerlink" title="38. 强引用置null是否回收"></a>38. 强引用置null是否回收</h1><p>是。</p>
<hr>
<h1 id="39-介绍NDK和JNI"><a href="#39-介绍NDK和JNI" class="headerlink" title="39. 介绍NDK和JNI"></a>39. 介绍NDK和JNI</h1><hr>
<h1 id="40-多进程的场景"><a href="#40-多进程的场景" class="headerlink" title="40. 多进程的场景"></a>40. 多进程的场景</h1><hr>
<h1 id="41-JVM相关"><a href="#41-JVM相关" class="headerlink" title="41. JVM相关"></a>41. JVM相关</h1><p>参见博客。</p>
<hr>
<h1 id="42-equals和-的区别"><a href="#42-equals和-的区别" class="headerlink" title="42. equals和==的区别"></a>42. equals和==的区别</h1><p><code>==</code> 仅在相比较的对象就是自己本身时，才返回 <code>true</code>。而 <code>equals</code> 是 Object 类中的方法，其返回值可以根据需求定义，默认情况下，<code>equals</code> 返回的也是 <code>==</code> 的值，但在像 HashMap、Array 中等则会返回 key 或 value 是否相等。</p>
<p>由于 String 和常数是存放在常量池，因此直接比较 String 的值时，相同的字符串两个都会返回 <code>true</code>，例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">String sa = <span class="string">"123"</span>;</span><br><span class="line">String sb = <span class="string">"123"</span>;</span><br><span class="line">String sc = <span class="keyword">new</span> String(<span class="string">"123"</span>);</span><br><span class="line">String sd = <span class="keyword">new</span> String(<span class="string">"123"</span>);</span><br><span class="line"></span><br><span class="line">sa == sb <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">sa.equals(sb) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">sc == sd <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">sc.equals(sd) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">42</span> == <span class="number">42.00</span> <span class="keyword">return</span> <span class="keyword">true</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="为什么重写了-equals还要重写hashcode"><a href="#为什么重写了-equals还要重写hashcode" class="headerlink" title="为什么重写了 equals还要重写hashcode"></a>为什么重写了 equals还要重写hashcode</h1><p>默认情况下，equals比较的是两个对象的内存地址是否相等，重写equals 方法通常是转换成比较值是否相等，如果重写了equals方法而不重写hashcode方法，默认情况下hashcode是根据对象的内存地址计算的，则可能出现equals为true而hashcode不相等的情况，这和hashcode的本意是不符的。HashCode不相等的两个对象一定不相等，相等的两个对象HashCode一定向等。</p>
<hr>
<h1 id="43-自己设计一个图片浏览器"><a href="#43-自己设计一个图片浏览器" class="headerlink" title="43. 自己设计一个图片浏览器"></a>43. 自己设计一个图片浏览器</h1><p>首先要考虑到会加载多图和大图的情况。</p>
<p>（1）对于多图，采用预览图和本地缓存的形式，首次进入后，先从本地读取图片并加载预览小图，然后写入本地缓存，下次进入时，先从本地加载小图缓存，然后异步获取图片的更新，图片有更新时再重新缓存。并且在进入 App 后，根据显示的范围，缓存上下两行或者左右两列的图片，滑动时能提供更好的视觉效果，如果是纯粹的图片浏览器，其图片变动不大，则还可以将预览小图缓存到内存中。</p>
<p>（2）对于大图，采用优化加载的方式，点击小图进入大图时，先预加载图片的宽高信息，如果图片和实际显示范围差别不大，则可以直接加载进来，如果图片远大于实际可显示范围，则首先压缩到当前可显示范围的大小，或者将 BitMap 裁剪到当前的显示范围再显示，然后用户双击放大的时候，利用 <code>BitmapRegionDecoder</code> 绘制实际原图的局部，并且配合 GestureDetector 监听手势滑动，来不断的绘制不同的位置，用户在缩小后，如果用户马上切换另一个大图，则将前一个大图的 Bitmap 清空，然后复用，否则设置一个定时方法，在一定时间内，保存前一个大图 Bitmap 的缓存，这样用户再次打开时就不用重复加载，如果超时，再回收该 Bitmap 对象。</p>
<p>（3）对于 App 整体，还要有个队列或者链表，用来记录整体内存占用，例如在大图模式下，假如内存占用接近或超过了预期的最大值，则释放掉之前小图模式下的内存，用户再退出大图模式后再重新加载图片列表。</p>
<hr>
<h1 id="44-VersionCode和VersionName"><a href="#44-VersionCode和VersionName" class="headerlink" title="44. VersionCode和VersionName"></a>44. VersionCode和VersionName</h1><p>VersionCode 是唯一标识 App 版本迭代的号码，只能是整数，是面向程序、系统、应用市场和开发人员内部的，VersionCode 更大的 App 更新。</p>
<p>VersionName 更像是提供给用户的信息，可以按照不同的规定写，是 String 类型的。</p>
<hr>
<h1 id="45-JVM五个区"><a href="#45-JVM五个区" class="headerlink" title="45. JVM五个区"></a>45. JVM五个区</h1><p>参见博客。</p>
<hr>
<h1 id="46-方法区是否会OOM"><a href="#46-方法区是否会OOM" class="headerlink" title="46. 方法区是否会OOM"></a>46. 方法区是否会OOM</h1><p>会。在 JDK 1.8 以前，HotSpot 虚拟机的方法区是用永久代实现的，方法区的内存固定，因此如果频繁调用 String.intern() 方法，或者一次性加载太多类，会导致OOM。JDK 1.8 之后，虽然用元数据取代了方法区，直接使用本地内存，支持扩容，也取消了永久代，但并不是无限扩容的，所以仍然会，只是几率会小一些。</p>
<hr>
<h1 id="内部类为什么要用final修饰变量"><a href="#内部类为什么要用final修饰变量" class="headerlink" title="内部类为什么要用final修饰变量"></a>内部类为什么要用final修饰变量</h1><p>局部变量在传递给内部类，实际上在编译时，是给内部类的构造方法增加了一个参数，并原来的将局部变量传入了构造方法，如果不加 final，可能会出现，原来的局部变量在传入之后，改变了引用，但因为内部类的构造方法接收到的是原来的变量的引用的拷贝，就会导致内部类使用的这个传进来的变量的引用和原本局部变量的引用不一样，则执行的结果就不是预期的，所以需要加上 final，强制使得其引用不可改变。而成员变量则不需要是因为，内部类会持有外部类的引用，外部类的成员变量，在内部类使用时，是通过所持有的外部类的引用对象来调用的，并没有创建引用的拷贝，所以和外部类成员变量的引用是一致的。</p>
<hr>
<h1 id="final关键字修饰方法，变量，类有什么作用"><a href="#final关键字修饰方法，变量，类有什么作用" class="headerlink" title="final关键字修饰方法，变量，类有什么作用"></a>final关键字修饰方法，变量，类有什么作用</h1><p>final 修饰方法，则该方法不可被重写，例如 Handler 中所有的post和send方法<br>final 修饰变量，则该变量的引用不可改变（但是值可以改变，例如final HashMap）<br>final 修饰类，则该类不可被继承，例如System类</p>
<hr>
<h1 id="ListView、RecyclerView优化方法"><a href="#ListView、RecyclerView优化方法" class="headerlink" title="ListView、RecyclerView优化方法"></a>ListView、RecyclerView优化方法</h1><p>ListView：</p>
<p>Adapter.getView中，ConvertView==null时，说明当前的Item的View还没创建，LayoutInflate一个View，否则说明View可复用，直接让View=convertView。</p>
<p>根据每个Item都有的布局创建一个ViewHolder，这个ViewHolder保存了每一个Item通用的布局的View的对象，如果ConvertView==null，说明当前Item的View还没创建，则新建一个ViewHolder并将该Holder存入View.tag里，否则说明可复用，直接getTag取出holder，然后重新给里面的View对象赋值。</p>
<p>RecyclerView：</p>
<p>onBindViewHolder运行在UI线程中，尽量避免耗时操作</p>
<p>数据量较大时，用DiffUtil代替notifyDataSetChanged，只刷新局部数据：<br>DiffUtil.DiffResult diffResult = DiffUtil.calculateDiff(new DiffCallBack(oldDatas, newDatas), true);<br>diffResult.dispatchUpdatesTo(mAdapter);<br>其本质是计算出新旧数据具体在哪些地方和哪一段发生了变化，然后根据实际情况调用：<br>mAdapter.notifyItemRangeInserted(position, count);<br>mAdapter.notifyItemRangeRemoved(position, count);<br>mAdapter.notifyItemMoved(fromPosition, toPosition);<br>mAdapter.notifyItemRangeChanged(position, count, payload);<br>来实现的。</p>
<p>布局优化，减少Item的过度绘制、减少Item的层级</p>
<p>RecyclerView的Item很灵活，因此每一次加载，都会调用requestLayout来刷新父布局，如果所有Item的高度固定，可以调用RecyclerView.setHasFixedSize(true);避免</p>
<p>如果RecyclerView嵌套了RecyclerView，且可以使用相同的Adapter，则可以设置RecyclerView.setRecycledViewPool(pool)来共用一个RecycledViewPool，如果LayoutManager是LinearLayoutManager或其子类，需要手动开启：layout.setRecycleChildrenOnDetach(true)</p>
<hr>
<h1 id="Java线程同步机制与原理"><a href="#Java线程同步机制与原理" class="headerlink" title="Java线程同步机制与原理"></a>Java线程同步机制与原理</h1><p>（1）volatile</p>
<p>volatile一般用在多个线程访问同一个变量时，对该变量进行唯一性约束，volatile保证了变量的可见性，不能保证原子性。</p>
<p>用法（例）：<code>private volatile boolean flag = false;</code></p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">Thread write = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        i = <span class="number">2</span>;</span><br><span class="line">        flag = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">Thread read = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(flag) &#123;</span><br><span class="line">            System.out.println(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">write.start();</span><br><span class="line">read.start();</span><br></pre></td></tr></table></figure>

<p>上述代码，在某些极端情况下，可能会输出 1，也就是：write 线程中，先执行了 <code>flag = true</code>，然后 read 线程执行了 <code>if</code> 判断并通过，输出 1，然后 write 线程才执行 <code>i = 2</code>，为了避免这个情况，可以如下改写：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">volatile</span> <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">Thread write = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        i = <span class="number">2</span>;</span><br><span class="line">        flag = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">Thread read = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(flag) &#123;</span><br><span class="line">            System.out.println(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">write.start();</span><br><span class="line">read.start();</span><br></pre></td></tr></table></figure>

<p>volatile用于告诉JVM变量不允许线程缓存以及代码重排序，会使得其所在域的写操作一定发生在读操作之前，且每次有写操作后，都将所在域中的写入值同步到主内存中，从而避免其他线程从缓存中拿到旧数据。</p>
<p>（2）Synchronized</p>
<p>synchronized只会同步尝试获取同一个monitor对象的线程，如果一个线程已经持有该monitor，则后续所有尝试持有该monitor的线程都需要依次等待前面的线程释放monitor才能继续执行。</p>
<p>（3）Lock</p>
<p>Lock lock = new ReentrantLock();<br>可以通过lock.lock()和lock.unlock()手动加锁、释放锁。性能很差。注意在finally中释放锁。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Lock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"><span class="keyword">int</span> value = <span class="number">1</span>;</span><br><span class="line">lock.lock();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    value++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">finally</span> &#123;</span><br><span class="line">    lock.unlock;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="synchronized如何保证原子性"><a href="#synchronized如何保证原子性" class="headerlink" title="synchronized如何保证原子性"></a>synchronized如何保证原子性</h1><p>所谓原子性指的是不会被线程调度机制打断的操作，java中对基本数据类型的读和写是原子性操作，但自增自减不是。例如：i++ 在 JVM 中实际上是三步：① 取出 i 的值，② 对值 +1 操作，③ 重新赋值给 i，虽然其中的每一步都是原子性操作，但这个过程并不是原子性的。如果需要保证原子性，可以：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;i++;&#125;</span><br></pre></td></tr></table></figure>

<p>或者使用原子类：java.util.concurrent下的AtomicInteger、AtomicLong、AtomicReference等，其中AtomicInteger.getAndIncrement()效果相当于i++，AtomicInteger.getAndDecrement()效果相当于i–，AtomicInteger.incrementAndGet()效果相当于++i，其内部原理：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">getAndIncrement</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="keyword">int</span> current = get();</span><br><span class="line">        <span class="keyword">int</span> next = current + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (compareAndSet(current, next))</span><br><span class="line">            <span class="keyword">return</span> current;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="接口和类的区别和联系"><a href="#接口和类的区别和联系" class="headerlink" title="接口和类的区别和联系"></a>接口和类的区别和联系</h1><p>接口没有构造方法，不能实例化对象。在实际使用中，有时也可以通过 new 接口并实现其内部方法，但其实是通过匿名内部类实现的，所以本质上还是类的实例化。</p>
<p>接口中的方法必须是抽象方法，尽管可以不用 abstract 修饰，但在接口内不能实现具体的方法，而实现接口时也必须实现接口的全部方法。</p>
<p>接口不能包含成员变量，但可以有 static 和 final 修饰的常量。</p>
<p>一个类只能继承自另一个类，但可以实现多个接口。</p>
<p>接口可以将引用指向实现该接口的类对象，例如 List 接口和 LinkedList 类可以这么使用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List list = <span class="keyword">new</span> LinkedList();</span><br></pre></td></tr></table></figure>

<p>抽象类中的方法可以有方法体，接口中的方法不能。</p>
<p>接口中的方法会被隐式指定为 public abstract，也即接口是暴露给其他对象使用的，所以方法只能是public</p>
<hr>
<h1 id="抽象类和接口的区别"><a href="#抽象类和接口的区别" class="headerlink" title="抽象类和接口的区别"></a>抽象类和接口的区别</h1><p>从使用上来讲：</p>
<p>1、抽象类使用abstract修饰；<br>2、抽象类不能实例化，即不能使用new关键字来实例化对象；<br>3、含有抽象方法（使用abstract关键字修饰的方法）的类是抽象类，必须使用abstract关键字修饰；<br>4、抽象类可以含有抽象方法，也可以不包含抽象方法，抽象类中可以有具体的方法；<br>5、如果一个子类实现了父类（抽象类）的所有抽象方法，那么该子类可以不必是抽象类，否则就是抽象类</p>
<p>从逻辑上来讲：</p>
<p>抽象类的本质还是一个类，可以为子类定义所需的逻辑，本质上是对子类的抽象，也能通过实际实现方法，直接统一子类的行为，而接口更像是预先安排一些功能，而对于实现了这个接口的类的外部而言，其他类并不需要关心这个类具体的功能或实现，只需要根据其实现的接口就能调用相关的功能。</p>
<hr>
<h1 id="hashmap-hasTable-ConcurrentHashMap的区别"><a href="#hashmap-hasTable-ConcurrentHashMap的区别" class="headerlink" title="hashmap hasTable ConcurrentHashMap的区别"></a>hashmap hasTable ConcurrentHashMap的区别</h1><p>HashTable 的 Key 和 Value 都不能为 null，线程安全，在修改数据时给 put() 加锁锁住整个HashTable。</p>
<p>hashmap key 和 value 都可以是 null，线程不安全。</p>
<p>concurrentHashMap 将整个 Map 分段为 N 个 Segment，每个 Segment 独立加锁，对于需要跨段的操作（如 size() 和 containsValue()）则按顺序锁住所有段，操作完毕后再按顺序释放所有段的锁。且 Entry.value 添加了 volatile 字段，确保读操作获取到的是最新的数据，因此是线程安全的。</p>
<hr>
<h1 id="ClassLoader原理"><a href="#ClassLoader原理" class="headerlink" title="ClassLoader原理"></a>ClassLoader原理</h1><p><a href="http://blog.sina.com.cn/s/blog_6383597b0100fsiw.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_6383597b0100fsiw.html</a></p>
<p>ClassLoader 查找类的步骤：<a href="https://blog.csdn.net/hngmduyi/article/details/84292549" target="_blank" rel="noopener">https://blog.csdn.net/hngmduyi/article/details/84292549</a></p>
<hr>
<h1 id="Fragment-懒加载"><a href="#Fragment-懒加载" class="headerlink" title="Fragment 懒加载"></a>Fragment 懒加载</h1><p>关键点在于 setUserVisibleHint()，会在 onCreateView 之前执行，当 Fragment 可见状态改变时调用，设置一个 boolean 成员变量，用于标志是否已经加载过，在setUserVisibleHint()中，如果没加载过且可见，则加载数据，并将boolean标志为已加载。再把实际加载 View 的部分放进加载的方法里面。</p>
<hr>
<h1 id="RecyclerView在很多方面能取代ListView，Google为什么还不弃用ListView？"><a href="#RecyclerView在很多方面能取代ListView，Google为什么还不弃用ListView？" class="headerlink" title="RecyclerView在很多方面能取代ListView，Google为什么还不弃用ListView？"></a>RecyclerView在很多方面能取代ListView，Google为什么还不弃用ListView？</h1><p>在某些轻量级场景下，例如纯文字的列表时，RecyclerView强制使用Holder的形式芳儿增加了开销，而且开发成本也更高一些。</p>
<hr>
<h1 id="Java泛型的作用"><a href="#Java泛型的作用" class="headerlink" title="Java泛型的作用"></a>Java泛型的作用</h1><p>泛型即<code>&lt;T&gt;</code>，</p>
<hr>
<h1 id="Object方法"><a href="#Object方法" class="headerlink" title="Object方法"></a>Object方法</h1><ul>
<li>Object()<br>构造函数。</li>
<li>clone()<br>用来另存一个当前存在的对象。</li>
<li>equals(Object)<br>用于确认两个对象是否相同。</li>
<li>finalize()<br>这个函数在进行垃圾回收的时候会用到，匿名对象回收之前会调用到。</li>
<li>getClass()<br>返回一个Class对象，如果打印出来会发现结果是如下格式<br>class package.name.xxx</li>
<li>hashCode()<br>用于获取对象的哈希值，这个值的作用是检索。</li>
<li>notify()<br>用于随机通知一个持有对象的锁的线程获取操作权限。</li>
<li>notifyAll()<br>用于通知所有持有对象的锁的线程获取操作权限。</li>
<li>toString()<br>返回一个String对象，用来标识自己。</li>
<li>wait()<br>用于让当前线程失去操作权限，当前线程进入等待序列。</li>
<li>wait(long)<br>用于设定下一次获取锁的距离当前释放锁的时间间隔。</li>
<li>wait(long,int)<br>用于设定下一次获取锁的距离当前释放锁的时间间隔。</li>
</ul>
<hr>
<h1 id="Java面向对象六大原则："><a href="#Java面向对象六大原则：" class="headerlink" title="Java面向对象六大原则："></a>Java面向对象六大原则：</h1><p>（1）单一职责原则</p>
<p>1.原则：两个完全不一样的功能不能放在一个类中，一个类应该是一组相关性很高的函数、数据的封装<br>2.如何划分一个类的职责 因人而异，单一要根据个人的经验、具体的业务来定<br>3.比如图片加载和缓存应该放在不同的类中</p>
<p>（2）开放关闭原则</p>
<p>1.原则：软件中的函数、对象，应该对于扩展是开放的，对于修改是封闭的<br>2.当软件需要变化时，应该尽量通过扩展的方式，而不是修改已有的代码</p>
<p>（3）里氏替换原则</p>
<p>1.原则：所有引用基类的地方，必须能透明地使用其子类的对象<br>2.只要父类出现的地方，子类就可以出现，替换为子类也不影响。但是反之不行。<br>3.核心是抽象，抽象又依赖于继承。建立抽象，通过抽象建立规范，具体的实现在继承时替换掉。往往和开闭原则一起，通过接口和抽象的方式</p>
<p>（4）依赖倒置原则</p>
<p>1.原则：实现类直接不直接发生依赖关系，其依赖关系通过接口或抽象类产生，即：面向接口编程<br>2.java中，抽象指接口或抽象类，两者不能直接被实例化；细节是实现接口或继承抽象类的实现类，可以直接被实例化，new一个对象</p>
<p>（5）接口隔离原则</p>
<p>1.原则：类之间的依赖关系应该建立在最小接口上。让客户端依赖的接口尽可能小，解耦合。<br>2.前五个职责总结为：单一职责、抽象、最小化</p>
<p>（6）迪米特原则</p>
<p>1.最少知识原则：一个对象应该对其他对象有最少的了解。因为关系越密切，则耦合度越大<br>2.只与直接的朋友通信</p>
<hr>
<h1 id="Java反射"><a href="#Java反射" class="headerlink" title="Java反射"></a>Java反射</h1><h2 id="反射的使用："><a href="#反射的使用：" class="headerlink" title="反射的使用："></a>反射的使用：</h2><p>（1）已经编译成 .class 的类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">aClass</span> </span>= AClass.class;</span><br></pre></td></tr></table></figure>

<p>（2）动态生成 class 对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    Class aClass = Class.forName(<span class="string">"AClass"</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span>(ClassNotFoundException e) &#123;</span><br><span class="line">    System.out.println(<span class="string">"找不到 AClass 类"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>getModifiers()可以获取一个类的修饰符，再结合：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Modifier.isAbstract(<span class="keyword">int</span> modifiers)</span><br><span class="line">Modifier.isFinal(<span class="keyword">int</span> modifiers)</span><br><span class="line">Modifier.isInterface(<span class="keyword">int</span> modifiers)</span><br><span class="line">Modifier.isNative(<span class="keyword">int</span> modifiers)</span><br><span class="line">Modifier.isPrivate(<span class="keyword">int</span> modifiers)</span><br><span class="line">Modifier.isProtected(<span class="keyword">int</span> modifiers)</span><br><span class="line">Modifier.isPublic(<span class="keyword">int</span> modifiers)</span><br><span class="line">Modifier.isStatic(<span class="keyword">int</span> modifiers)</span><br><span class="line">Modifier.isStrict(<span class="keyword">int</span> modifiers)</span><br><span class="line">Modifier.isSynchronized(<span class="keyword">int</span> modifiers)</span><br><span class="line">Modifier.isTransient(<span class="keyword">int</span> modifiers)</span><br><span class="line">Modifier.isVolatile(<span class="keyword">int</span> modifiers)</span><br></pre></td></tr></table></figure>

<p>即可确定类的修饰符。</p>
<p>getSuperclass()可返回父类对象，Constructor getConstructors()可以获取所有声明为public的构造方法数组，getConstructor(new Class[]{String.class})获取指定参数的构造方法。</p>
<p>invoke()可以根据方法名调用方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Class birdClass = Bird.class;</span><br><span class="line">Constructor constructors1 = birdClass.getConstructor();</span><br><span class="line">Method eatMetchod = birdClass.getMethod(<span class="string">"eat"</span>, <span class="keyword">new</span> Class[]&#123;<span class="keyword">int</span>.class&#125;);</span><br><span class="line">System.out.println(eatMetchod.invoke(constructors1.newInstance(), <span class="number">2</span>));</span><br></pre></td></tr></table></figure>

<p>invoke第一个参数为需要调用方法的对象，第二个参数为需要传入的参数，如有多个参数则使用数组。</p>
<hr>
<h1 id="接口回调与观察者模式的选择"><a href="#接口回调与观察者模式的选择" class="headerlink" title="接口回调与观察者模式的选择"></a>接口回调与观察者模式的选择</h1><p>回调是一对一的关系，只监听一个事件；观察者模式则是一个主题，可以有多个监听，当主题变化时，向所有（也可以试部分）这些监听发出变化通知，观察者模式是一对多的关系。</p>
<hr>
<h1 id><a href="#" class="headerlink" title></a></h1>
      
    </div>

    

    
    
    

    
    
    
    <div>
      
        <div>
    
	<br> <br> <br>
	<div style="text-align:center;color: #678;font-size:18px;">======================</div>
        <div style="text-align:center;color: #678;font-size:18px;">全 文 结 束&ensp;&ensp;<i class="fa fa-leanpub"></i>&ensp;&ensp;感 谢 阅 读</div>
	<div style="text-align:center;color: #678;font-size:18px;">======================</div>
    
</div>
      
    </div>

    
    
    
    
      <div>
        




  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>SLLiu</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    
    <a href="https://www.liushulun.cn/post/note/Android-temp/" title="Android面试临时总结">https://www.liushulun.cn/post/note/Android-temp/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>
    

    
    
    
    

    
    
    
    
      
    
    
      <div>
        <div id="reward-container">
  <div>感谢鼓励</div>
  <button id="reward-button" disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    赞赏
  </button>
  <div id="qr" style="display: none;">

    
      
      
        
      
      <div style="display: inline-block">
        <img src="/images/wechatpay.png" alt="SLLiu 微信支付">
        <p>微信支付</p>
      </div>
    
      
      
        
      
      <div style="display: inline-block">
        <img src="/images/alipay.png" alt="SLLiu 支付宝">
        <p>支付宝</p>
      </div>
    

  </div>
</div>

      </div>
    

    
    
    
    <footer class="post-footer">

    

      
      
      

      
      
      
      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/post/interview/interview-java/" rel="next" title="Java面试题汇总">
                <i class="fa fa-chevron-left"></i> Java面试题汇总
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
      
        
        <div class="underline" style="width: 100%; display: inline-block">
          <style>
          .underline{ padding-bottom:1px; border-bottom:1px solid #EB6D39}
          </style>
          <span style="width: 100%; font-size: 13px; color: #EB6D39;">
            
            <div style="cursor: pointer; font-size: 13px; color: #EB6D39; display: inline-block" onclick="window.location='#';">
            页首
            </div>
            &ensp;|&ensp;
            
            <div style="cursor: pointer; font-size: 13px; color: #EB6D39; display: inline-block" onclick="window.location='/';">
            主页
            </div>
            &ensp;|&ensp;
            
            <div style="cursor: pointer; font-size: 13px; color: #EB6D39; display: inline-block" onclick="window.scrollBy(0, document.getElementsByTagName('BODY')[0].scrollHeight);">
            评论
            </div>
          </span>
        </div>
      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            本文目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            博客信息
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="SLLiu">
            
              <p class="site-author-name" itemprop="name">SLLiu</p>
              <div class="site-description motion-element" itemprop="description">Learn, or Lose</div>
          </div>

          
            <nav class="site-state motion-element">

              
              <div class="site-state-item">
                
                <span class="site-state-item-count">764</span>
                <span class="site-state-item-name">版本</span>
              </div>

              
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    
                    <span class="site-state-item-count">54</span>
                    <span class="site-state-item-name">文章</span>
                  </a>
                </div>
              

              
              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">11</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">71</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/slliu96" title="GitHub &rarr; https://github.com/slliu96" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="/about/" title="Chats &rarr; /about/"><i class="fa fa-fw fa-comments"></i>Chats</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://weibo.com/u/1842855041" title="Weibo &rarr; https://weibo.com/u/1842855041" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:lsldev@163.com" title="EMail &rarr; mailto:lsldev@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>EMail</a>
                </span>
              
            </div>
          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-users"></i>
                
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://renxingkai.github.io" title="https://renxingkai.github.io" rel="noopener" target="_blank">CinKate</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://me.csdn.net/singwhatiwanna" title="https://me.csdn.net/singwhatiwanna" rel="noopener" target="_blank">任玉刚</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-Handler工作原理√"><span class="nav-text">1. Handler工作原理√</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-介绍一下FFmpeg"><span class="nav-text">4. 介绍一下FFmpeg</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四大组件√"><span class="nav-text">四大组件√</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#getWidth和getMeasureWidth的区别√"><span class="nav-text">- getWidth和getMeasureWidth的区别√</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#finally什么时候执行√"><span class="nav-text">finally什么时候执行√</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#App架构√"><span class="nav-text">App架构√</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Java引用的实现√"><span class="nav-text">Java引用的实现√</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HashMap√"><span class="nav-text">- HashMap√</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#JVM的内存模型和分区√"><span class="nav-text">JVM的内存模型和分区√</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#方法区是否会OOM√"><span class="nav-text">方法区是否会OOM√</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#GC垃圾回收机制√"><span class="nav-text">GC垃圾回收机制√</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-StringBuffer和StringBuilder"><span class="nav-text">5. StringBuffer和StringBuilder</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-Android触摸事件"><span class="nav-text">6. Android触摸事件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-TCP三次握手"><span class="nav-text">7. TCP三次握手</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-TCP四次挥手"><span class="nav-text">8. TCP四次挥手</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-基于-TCP-的-Socket："><span class="nav-text">9. 基于 TCP 的 Socket：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-基于-UDP-的-Socket："><span class="nav-text">10. 基于 UDP 的 Socket：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#12-隐式启动Service"><span class="nav-text">12. 隐式启动Service</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#14-View的绘制流程"><span class="nav-text">14. View的绘制流程</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#15-了解的设计模式"><span class="nav-text">15. 了解的设计模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#15-1-单例模式"><span class="nav-text">15.1 单例模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#15-1-1-饿汉式"><span class="nav-text">15.1.1 饿汉式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-1-2-懒汉式"><span class="nav-text">15.1.2 懒汉式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-1-3-线程安全的懒汉式"><span class="nav-text">15.1.3 线程安全的懒汉式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-1-4-双锁检测"><span class="nav-text">15.1.4 双锁检测</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-1-5-静态内部类"><span class="nav-text">15.1.5 静态内部类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#15-2-工厂模式"><span class="nav-text">15.2 工厂模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#15-2-1-简单工厂模式"><span class="nav-text">15.2.1 简单工厂模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-2-2-抽象工厂模式"><span class="nav-text">15.2.2 抽象工厂模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-2-3-工厂方法模式"><span class="nav-text">15.2.3 工厂方法模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#15-3-建造者模式"><span class="nav-text">15.3 建造者模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#15-4-中介者模式"><span class="nav-text">15.4 中介者模式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#16-开源框架"><span class="nav-text">16. 开源框架</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#17-多线程"><span class="nav-text">17. 多线程</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#18-HTTP和HTTPS"><span class="nav-text">18. HTTP和HTTPS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#18-1-HTTP"><span class="nav-text">18.1 HTTP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#18-1-1-HTTP报文格式"><span class="nav-text">18.1.1 HTTP报文格式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#19-为什么View移动后点击事件还在原来的位置"><span class="nav-text">19. 为什么View移动后点击事件还在原来的位置</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#20-LRU算法"><span class="nav-text">20. LRU算法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#20-1-LRU算法原理"><span class="nav-text">20.1 LRU算法原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#20-2-LRU-K"><span class="nav-text">20.2 LRU-K</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#20-3-LRU-Two-Queues"><span class="nav-text">20.3 LRU-Two Queues</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#20-4-LRU-Multi-Queues"><span class="nav-text">20.4 LRU-Multi Queues</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#20-5-LRUCache"><span class="nav-text">20.5 LRUCache</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#21-内存泄漏和内存抖动检测"><span class="nav-text">21. 内存泄漏和内存抖动检测</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#21-1-检测内存泄漏"><span class="nav-text">21.1 检测内存泄漏</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#21-2-检测内存抖动"><span class="nav-text">21.2 检测内存抖动</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#22-wait-和sleep"><span class="nav-text">22. wait()和sleep()</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#23-Java中的锁"><span class="nav-text">23. Java中的锁</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#23-1-乐观锁和悲观锁"><span class="nav-text">23.1 乐观锁和悲观锁</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#23-2-同步锁"><span class="nav-text">23.2 同步锁</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#25-如何优化性能"><span class="nav-text">25. 如何优化性能</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#26-数据库常用增删改查语句"><span class="nav-text">26. 数据库常用增删改查语句</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#27-进程间通信"><span class="nav-text">27. 进程间通信</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#28-线程间通信"><span class="nav-text">28. 线程间通信</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#29-ANR和OOM及如何避免"><span class="nav-text">29. ANR和OOM及如何避免</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#29-1-ANR"><span class="nav-text">29.1 ANR</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#29-2-OOM"><span class="nav-text">29.2 OOM</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#30-Android为什么有签名机制以及如何理解"><span class="nav-text">30. Android为什么有签名机制以及如何理解</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#31-App沙箱化"><span class="nav-text">31. App沙箱化</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#32-权限管理系统"><span class="nav-text">32. 权限管理系统</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#33-常见排序算法"><span class="nav-text">33. 常见排序算法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#34-热修复的原理"><span class="nav-text">34. 热修复的原理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#35-ListView和RecyclerView性能对比和性能优化"><span class="nav-text">35. ListView和RecyclerView性能对比和性能优化</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#36-Bitmap加载大图"><span class="nav-text">36. Bitmap加载大图</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#37-Java中的引用"><span class="nav-text">37. Java中的引用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#37-1-四种引用关系"><span class="nav-text">37.1 四种引用关系</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#37-2-Java中引用的实现"><span class="nav-text">37.2 Java中引用的实现</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#38-强引用置null是否回收"><span class="nav-text">38. 强引用置null是否回收</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#39-介绍NDK和JNI"><span class="nav-text">39. 介绍NDK和JNI</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#40-多进程的场景"><span class="nav-text">40. 多进程的场景</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#41-JVM相关"><span class="nav-text">41. JVM相关</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#42-equals和-的区别"><span class="nav-text">42. equals和==的区别</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#为什么重写了-equals还要重写hashcode"><span class="nav-text">为什么重写了 equals还要重写hashcode</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#43-自己设计一个图片浏览器"><span class="nav-text">43. 自己设计一个图片浏览器</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#44-VersionCode和VersionName"><span class="nav-text">44. VersionCode和VersionName</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#45-JVM五个区"><span class="nav-text">45. JVM五个区</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#46-方法区是否会OOM"><span class="nav-text">46. 方法区是否会OOM</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#内部类为什么要用final修饰变量"><span class="nav-text">内部类为什么要用final修饰变量</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#final关键字修饰方法，变量，类有什么作用"><span class="nav-text">final关键字修饰方法，变量，类有什么作用</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ListView、RecyclerView优化方法"><span class="nav-text">ListView、RecyclerView优化方法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Java线程同步机制与原理"><span class="nav-text">Java线程同步机制与原理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#synchronized如何保证原子性"><span class="nav-text">synchronized如何保证原子性</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#接口和类的区别和联系"><span class="nav-text">接口和类的区别和联系</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#抽象类和接口的区别"><span class="nav-text">抽象类和接口的区别</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hashmap-hasTable-ConcurrentHashMap的区别"><span class="nav-text">hashmap hasTable ConcurrentHashMap的区别</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ClassLoader原理"><span class="nav-text">ClassLoader原理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fragment-懒加载"><span class="nav-text">Fragment 懒加载</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RecyclerView在很多方面能取代ListView，Google为什么还不弃用ListView？"><span class="nav-text">RecyclerView在很多方面能取代ListView，Google为什么还不弃用ListView？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Java泛型的作用"><span class="nav-text">Java泛型的作用</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Object方法"><span class="nav-text">Object方法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Java面向对象六大原则："><span class="nav-text">Java面向对象六大原则：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Java反射"><span class="nav-text">Java反射</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#反射的使用："><span class="nav-text">反射的使用：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#接口回调与观察者模式的选择"><span class="nav-text">接口回调与观察者模式的选择</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-text"></span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  



        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LiuShulun</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="博客总字数">360k</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="博客总阅读时长">6:40</span>
  
</div>









        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/affix.js?v=7.1.1"></script>

  <script src="/js/schemes/pisces.js?v=7.1.1"></script>




  
  <script src="/js/scrollspy.js?v=7.1.1"></script>
<script src="/js/post-details.js?v=7.1.1"></script>



  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  

  

  
  

<script src="//cdn1.lncld.net/static/js/3.11.1/av-min.js"></script>



  

<script src="https://cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js"></script>

<script>
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  var guest_header = 'nick,mail';
  guest_header = guest_header.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });

  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: '5s8VV1vNdnt4bKoTcocYcY0U-gzGzoHsz',
    appKey: 'YRRibTsHhmelPnfq41YO6B1r',
    placeholder: 'Nice !',
    avatar: 'identicon',
    guest_info: guest_header,
    meta: guest,
    pageSize: '5' || 10,
    visitor: true,
    lang: '' || 'zh-cn'
  });
  // 去除 Valine 版权信息
  var infoEle = document.querySelector('#comments .info');
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0){
    infoEle.childNodes.forEach(function(item) {
      item.parentNode.removeChild(item);
    });
  }
</script>





  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  


  

  

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


  

  

  

  

  

  

  

  

</body>
</html>

<!--动态浏览器标题-->
<script type="text/javascript" src="/custom/animator_title.js"></script>
